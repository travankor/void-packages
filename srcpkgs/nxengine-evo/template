# Template file for 'nxengine-evo'
pkgname=nxengine-evo
version=2.6.4
revision=1
build_style=cmake
configure_args="-DCMAKE_BUILD_TYPE=Release"
makedepends="libpng-devel libjpeg-turbo-devel SDL2_mixer-devel SDL2_image-devel"
short_desc="Complete rewrite of the jump-and-run platformer Cave Story"
maintainer="travankor <travankor@tuta.io>"
license="GPL-3.0-or-later"
homepage="http://www.cavestory.org/"
distfiles="https://github.com/nxengine/nxengine-evo/archive/v${version}.tar.gz
 https://www.cavestory.org/downloads/cavestoryen.zip"
checksum="482bb96ae0a778e17856a041237a5c53b581c0ed0e3b7da8bff9e70d283939f6
 aa87fa30bee9b4980640c7e104791354e0f1f6411ee0d45a70af70046aa0685f"
nocross="Builds part of the package with itself"

post_build() {
	cp -r data/ ../CaveStory/
	cd ../CaveStory
	../"${pkgname}-${version}"/bin/extract
}

do_install() {
	vbin bin/nx
	vmkdir usr/share/nxengine
	cp -r ../CaveStory/* ${DESTDIR}/usr/share/nxengine

# TODO: add for next update
#	vinstall platform/xdg/org.nxengine.nxengine_evo.desktop 644 usr/share/applications/
#	vinstall platform/xdg/org.nxengine.nxengine_evo.png 644 usr/share/pixmaps/
}
